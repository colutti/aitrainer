<div class="h-full relative overflow-hidden bg-dark-bg text-text-primary p-6 flex flex-col">
  <!-- Header -->
  <div class="flex justify-between items-end mb-6 flex-shrink-0">
    <div>
      <h1 class="text-3xl font-bold tracking-tight">HistÃ³rico</h1>
      <p class="text-text-secondary text-sm mt-1">{{ totalWorkouts() }} treinos registrados</p>
    </div>
    
    <!-- Filter -->
    <div class="relative">
      <select (change)="onTypeChange($event)" class="appearance-none bg-light-bg border border-secondary text-text-primary py-2 pl-4 pr-10 rounded-lg focus:outline-none focus:border-primary cursor-pointer hover:border-primary/50 transition-colors text-sm">
        <option value="all">Todos</option>
        <option *ngFor="let type of workoutTypes()" [value]="type">{{ type }}</option>
      </select>
      <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-text-secondary">
        <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
      </div>
    </div>
  </div>

  <!-- Loading -->
  <div *ngIf="isLoading()" class="flex-1 flex justify-center items-center">
    <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"></div>
  </div>

  <!-- List -->
  <div *ngIf="!isLoading()" class="flex-1 overflow-y-auto pr-2 custom-scrollbar relative">
    <div class="absolute left-[19px] top-0 bottom-0 w-0.5 bg-secondary/30 h-full"></div>
    
    <div class="space-y-4 pb-10 pt-2">
      
      <div *ngFor="let w of workouts()" class="relative pl-12 group cursor-pointer" (click)="selectWorkout(w)">
        <!-- Timeline Dot -->
        <div class="absolute left-[13px] top-1/2 -translate-y-1/2 w-3.5 h-3.5 rounded-full bg-dark-bg border-2 border-secondary group-hover:border-primary group-hover:bg-primary group-hover:scale-125 transition-all duration-300 z-10 box-border"></div>
        
        <!-- Card -->
        <div class="bg-light-bg p-4 rounded-xl border border-secondary group-hover:border-primary/50 group-hover:shadow-[0_0_15px_rgba(16,185,129,0.05)] transition-all duration-300 flex justify-between items-center transform group-hover:-translate-y-0.5 group-active:translate-y-0">
           <div class="flex items-center gap-4">
              <div class="w-10 h-10 rounded-lg bg-secondary/20 flex items-center justify-center text-xl">
                 {{ w.workout_type?.toLowerCase()?.includes('perna') ? 'ğŸ¦µ' : w.workout_type?.toLowerCase()?.includes('peito') ? 'ğŸ’ª' : w.workout_type?.toLowerCase()?.includes('costas') ? 'ğŸ¦' : 'ğŸ‹ï¸' }}
              </div>
              <div>
                 <h3 class="font-bold text-base text-white group-hover:text-primary transition-colors">{{ w.workout_type || 'Treino sem nome' }}</h3>
                 <p class="text-text-secondary text-xs font-medium mt-0.5 tracking-wide flex items-center gap-1">
                    <span>{{ w.date | date:'dd MMM yyyy' }}</span>
                    <span class="w-1 h-1 rounded-full bg-text-secondary opacity-50"></span>
                    <span>{{ w.duration_minutes || '--' }} min</span>
                 </p>
              </div>
           </div>
           
           <div class="text-secondary/50 group-hover:text-primary transition-colors transform group-hover:translate-x-1">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
           </div>
        </div>
      </div>

      <!-- Empty State -->
      <div *ngIf="workouts().length === 0" class="pl-12 pt-10 text-center text-text-secondary italic">
         <p>Nenhum treino encontrado.</p>
      </div>

    </div>
    
    <!-- Pagination -->
    <div *ngIf="workouts().length > 0" class="flex justify-between items-center py-4 border-t border-secondary mt-auto bg-dark-bg sticky bottom-0 z-20">
       <button (click)="previousPage()" [disabled]="currentPage() === 1" class="px-4 py-2 bg-light-bg rounded-lg border border-secondary text-text-secondary text-sm font-medium hover:text-white hover:bg-secondary/50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors">
          Anterior
       </button>
       <span class="text-text-secondary text-xs font-mono opacity-70">Pg {{ currentPage() }} / {{ totalPages() }}</span>
       <button (click)="nextPage()" [disabled]="currentPage() === totalPages()" class="px-4 py-2 bg-light-bg rounded-lg border border-secondary text-text-secondary text-sm font-medium hover:text-white hover:bg-secondary/50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors">
          PrÃ³xima
       </button>
    </div>
  </div>

  <!-- Drawer -->
  <app-workout-drawer 
      *ngIf="selectedWorkout()" 
      [workout]="selectedWorkout()!" 
      (close)="closeDrawer()">
  </app-workout-drawer>

</div>
